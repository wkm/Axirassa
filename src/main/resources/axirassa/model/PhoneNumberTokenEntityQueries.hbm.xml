<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE hibernate-mapping PUBLIC
      "-//Hibernate/Hibernate Mapping DTD 3.0//EN"
      "http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd">
<hibernate-mapping package="axirasa.model">
	<!-- get all tokens associated with a phone number -->
	<query name="tokens_by_phoneNumber">
		from PhoneNumberTokenEntity as token
		where 
			token.phoneNumberEntity = :phoneNumber
	</query>

	<!-- get phone number by token -->
	<!-- <query name="phoneNumber_by_token">
		select token.phoneNumber
		from PhoneNumberTokenEntity as token
		left join fetch token.phoneNumber
		where
			token = :token
	</query> -->
	
	<!-- remove expired phone numbers -->
	<query name="remove_expired_phoneNumberTokens">
		delete
		from PhoneNumberTokenEntity as token
		where
			token.expiration &lt; :date
	</query>
</hibernate-mapping>